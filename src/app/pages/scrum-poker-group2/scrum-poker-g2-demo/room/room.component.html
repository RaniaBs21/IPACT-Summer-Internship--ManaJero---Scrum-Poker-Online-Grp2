
<body>
<div class="container">

<!-----------------------------------  header ------------------------------->
  <div class="topnav">
   <!-- <div class="session-info">
      <span class="session-name">{{ session?.name }}</span>
    </div>-->
    <div class="dropdown-container">

      <span class="session-name" >{{ session?.name }} </span>
      <button class="btn btn-link dropdown-toggle" style="color:dimgrey" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false"  (click)="toggleDropdownSession()">
      </button>
      <ul *ngIf="isDropdownOpen" class="dropdown-content">
        <li (click)="openSessionUpdate(session)"><i class="fas fa-cog"></i> Game settings</li>
        <li ><i class="fas fa-history"></i> Voting History</li>
      </ul>
    </div>

    <button class="custom-button" (click)="toggleSidebar()">
      <img src="assets/images/menu.png" style="width: 45px; height: 40px"  class="button-icon" alt="desc">
    </button>
    <button class="custom-button" (click)="openInvitePlayers()">
      <img src="assets/images/invitation.png" style="width: 45px; height: 45px"  class="button-icon" alt="desc">
      Invite players
    </button>
  </div>

<!------------------------------  pick your card --------------------------------->
  <div class="button-container">
    <div class="button-wrapper">
      <br>
      <h1 *ngIf="!revealedCard && selectedCard === null">
        <span>P</span><span>I</span><span>C</span><span>K</span><span> </span><span>Y</span><span>O</span><span>U</span><span>R</span><span> </span><span>C</span><span>A</span><span>R</span><span>D</span><span>S</span><span>!</span>
      </h1>
      <button *ngIf="selectedCard !== null && !revealedCard" (click)="revealCard()" class="neon-shadow">
        Reveal card
      </button>
      <br>
      <button *ngIf="revealedCard" (click)="revealCard()" class="reveal-button" routerLink="createGame">
        start new voting
      </button>
    </div>
    <div class="container">
      <h1 *ngIf="revealedCard">
        <span>Your selected card: {{ revealedCard }}</span>
      </h1>

      <div class="average-agreement" *ngIf="revealedCard">
        <div class="average">
          <h5 style="color: #3A3A3A">Average:</h5>
          <h3>{{ selectedCard }}</h3>
        </div>
        <div class="vote">
          <h5 style="color: #3A3A3A">Vote:</h5>
          <h3>{{ selectedCard }}</h3>
        </div>
      </div>

    </div>
  </div>

<!----------------------------------  algo cards --------------------------------->
  <div class="cards">
    <div class="group relative h-40 cursor-pointer" *ngFor="let card of cards" [id]="'vote_card_' + card" (click)="selectCard(card)" [style.opacity]="selectedCard === card ? '1' : '0.5'" [ngClass]="{'selected': selectedCard === card}">
      <button class="card-button">{{ card }}</button>
    </div>
  </div>
</div>

<!------------------------------------------ Sidebar : issues --------------------------------->
<div class="sidebar" [class.open]="isSidebarOpen">
  <div class="sidebar-header">
    <h2>Issues</h2>
  </div>
  <div class="sidebar-content">
    <div class="header-container">

      <h5>issues</h5>
      <div class="dropdown-container">


          <img src="assets/images/import.png" width="50" height="50" class="spaced-img" (click)="toggleDropdown()"
               style="cursor:pointer;" alt="desc">
          <ul *ngIf="isDropdownOpen" class="dropdown-content">
            <li (click)="selectOption('jira')">Import from JIRA</li>
            <li (click)="selectOption('linear')">Import from Linear</li>
            <li (click)="selectOption('urls')">Add from URLs</li>
            <li (click)="selectOption('csv')">Import from CSV</li>
          </ul>
        </div>
        <img src="assets/images/close.png" width="50" height="50" (click)="toggleSidebar()" class="close-button" alt="desc">
    </div>
    <button class="btn btn-light" *ngIf="!showForm" (click)="toggleForm()">
      <img src="assets/images/addUserStory.png" width="45" height="45" alt="desc">
      Add An issues
    </button>


<!------------------------------ add issue form ------------------------->


    <div *ngIf="showForm" class="issue-form">
      <div class="scrollable-issues">
          <div *ngFor="let issue of issues" class="issue-item">
            <div class="issue-card">
              <div class="row">

                  <p style=" line-height: 1.75;">{{ issue.issueDescription }}</p>
                  <button
                    class="btn"
                    [class.voting]="issue.isVoting"
                    (click)="toggleVote(issue)">
                    {{ issue.isVoting ? 'Voting now...' : 'Vote !! ' }}
                  </button>

                  <div class="edit-delete-buttons">
                      <i class="far fa-edit fa-lg edit-icon" (click)="openIssueUpdate(issue)"></i>
                      <i class="fas fa-trash-alt fa-lg delete-icon" (click)="deleteIssue(issue.id)"></i>
                  </div>
              </div>

            </div>
          </div>

      <nb-card-body>
        <form [formGroup]="addIssuesForm" >
          <div class="form-group">
            <textarea rows="5" nbInput fullWidth shape="round" formControlName="issueDescription" placeholder="Enter a new issue"></textarea>
          </div>
        </form>
      </nb-card-body>
      <nb-card-footer class="footer-buttons">
        <div class="button-group">
          <button (click)="confirmIssueAdd()" class="btn btn-primary">Save</button>
          <button (click)="cancel()" class="btn btn-light">Cancel</button>
        </div>
      </nb-card-footer>
    </div>
    </div>
  </div>
</div>

<!------------------------------------ Overlay ------------------------------------>
<div class="overlay" [class.show]="isSidebarOpen" (click)="toggleSidebar()"></div>
</body>

<!----------------------------------- Close buton ------------------------------------>
<button class="close-button" style="background-color: orange" routerLink="result">
  <i class="fas fa-times"></i>
  Close Session
</button>

